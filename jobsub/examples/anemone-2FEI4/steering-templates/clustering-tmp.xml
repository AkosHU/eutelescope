<?xml version="1.0" encoding="us-ascii"?>
<!-- ?xml-stylesheet type="text/xsl" href="http://ilcsoft.desy.de/marlin/marlin.xsl"? -->
<!-- ?xml-stylesheet type="text/xsl" href="marlin.xsl"? -->


<!--

==========================================================================================
Steering file template for the pysub framework

==> clusearch-tmp.xml <===

Author: Antonio Bulgheroni, INFN <mailto:antonio.bulgheroni@gmail.com>
Version: $Id: clusearch-tmp.xml,v 1.9 2009-08-01 10:41:44 bulgheroni Exp $
==========================================================================================

-->

<marlin xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ilcsoft.desy.de/marlin/marlin.xsd">

  <execute>
    <processor name="AIDA"/>
      <processor name="MyEUTelUtilityPrintEventNumber"/>
      <processor name="ClusteringMimosa26"/>
      <processor name="ClusteringFEI4"/>
      <processor name="Correlator"/>
    <processor name="Save"/>
  </execute>

  <global>
    <parameter name="LCIOInputFiles"> @LcioPath@/run@RunNumber@.slcio </parameter>
    <parameter name="GearXMLFile" value="@GearFilePath@/@GearFile@"/>
    <parameter name="MaxRecordNumber" value="@MaxRecordNumber@"/>
    <parameter name="SkipNEvents" value="0"/>
    <parameter name="SupressCheck" value="false"/>
    <parameter name="Verbosity" value="MESSAGE4"/>
  </global>

  <processor name="AIDA" type="AIDAProcessor">
    <!--Processor that handles AIDA files. Creates on directory per processor.  Processors only need to create and fill the histograms, clouds and tuples. Needs to be the first ActiveProcessor-->
    <!-- compression of output file 0: false >0: true (default) -->
    <parameter name="Compress" type="int" value="1"/>
    <!-- filename without extension-->
     <parameter name="FileName" type="string" value=
    "@HistoPath@/run@RunNumber@-clu-histo@MemCheckFlag@"/>
    <!-- type of output file xml (default) or root ( only OpenScientist)-->
    <parameter name="FileType" type="string" value="root"/>
  </processor>

<processor name="MyEUTelUtilityPrintEventNumber" type="EUTelUtilityPrintEventNumber">
 <!--EUTelUtilityPrintEventNumber prints event number to screen depending on the verbosity level-->
  <!--Print event number for every n-th event-->
  <parameter name="EveryNEvents" type="int" value="1000"/>
  <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
  <!--parameter name="Verbosity" type="string" value=""/-->
  <!--print the event timestamp as read from LCIO-->
  <!--parameter name="printTimestamp" type="bool" value="false"/-->
</processor>

  <processor name="ClusteringMimosa26" type="EUTelProcessorSparseClustering">
    <!--EUTelProcessorSparseClustering is looking for clusters into a calibrated pixel matrix.-->
       <parameter name="PulseCollectionName" type="string" value="cluster_m26"/>
       <parameter name="ZSDataCollectionName" type="string" value="zsdata_m26"/>

  </processor>

 
   <processor name="ClusteringFEI4" type="EUTelProcessorSparseClustering">

	<!--This is the name of the histogram information file-->
    <parameter name="PulseCollectionName" type="string" value="cluster_apix"/>
    <parameter name="ZSDataCollectionName" type="string" value="zsdata_apix"/>
    <parameter name="HistoInfoFileName" type="string" value="@HistoInfoPath@/@HistoInfo@"/>

  </processor>

  <processor name="Correlator" type="EUTelCorrelator">
    <!--EUTelCorrelator fills histograms with correlation plots-->
    <!--Cluster (pulse) collection name-->
    <parameter name="InputClusterCollections" type="StringVec" > cluster_m26 cluster_apix </parameter>
    <!-- -->
    <parameter name="ClusterChargeMinimum" type="int" value="1"/>
    <!-- -->
    <parameter name="MinNumberOfCorrelatedHits" type="int" value="7"/>
    <parameter name="Events"  type="int" value="999"/>

    <!--Residual cuts along both size in microns-->
    <parameter name="ResidualsXMax" type="FloatVec">  20.  20.  20.      20.0   20.0    20.0  20.0  20.0          </parameter>
    <parameter name="ResidualsXMin" type="FloatVec"> -20. -20. -20.     -20.0  -20.0   -20.0 -20.0 -20.0          </parameter>
    <parameter name="ResidualsYMax" type="FloatVec">  20.  20.  20.      20.0   20.0    20.0  20.0  20.0          </parameter>
    <parameter name="ResidualsYMin" type="FloatVec"> -20. -20. -20.     -20.0  -20.0   -20.0 -20.0 -20.0          </parameter>

  </processor>

  <processor name="HotPixelKiller" type="EUTelHotPixelKiller">
    <!--EUTelHotPixelKiller periodically check for pixel singing loud too often and remove them from the analysis-->
    <!--Pixel status collection-->
    <parameter name="StatusCollectionName" type="string" lcioInType="TrackerRawData"> m26_status </parameter>
    <!--This float number [0,1] represents the maximum allowed firing frequency
        within the selected number of event per cycle-->
    <parameter name="MaxAllowedFiringFreq" type="float" value="0.01"/>
    <!--The number of events to be considered for each update cycle-->
    <parameter name="NoOfEventPerCycle" type="int" value="1000"/>
    <!--The total number of hot pixel cycle-->
    <parameter name="TotalNoOfCycle" type="int" value="0"/>
  </processor>

  <processor name="Save" type="EUTelOutputProcessor">
    <!--Writes the current event to the specified LCIO outputfile. Eventually it adds a EORE at the of the file if it was missing Needs to be the last ActiveProcessor.-->
    <!--drops the named collections from the event-->
    <parameter name="DropCollectionNames" type="StringVec"> 
           rawdata status noise pedestal data zsdata 
            zsdata_m26 zsdata_apix
    </parameter>
    <!--drops all collections of the given type from the event-->
    <!--parameter name="DropCollectionTypes" type="StringVec"> SimTrackerHit SimCalorimeterHit </parameter-->
    <!-- write complete objects in subset collections to the file (i.e. ignore subset flag)-->
    <!--parameter name="FullSubsetCollections" type="StringVec" value="MCParticlesSkimmed"/-->
    <!--force keep of the named collections - overrules DropCollectionTypes (and DropCollectionNames)-->
    <!--parameter name="KeepCollectionNames" type="StringVec" value="MyPreciousSimTrackerHits"/-->
    <!-- name of output file -->
    <parameter name="LCIOOutputFile" type="string" value="@ResultsPath@/run@RunNumber@-clu@MemCheckFlag@.slcio"/>
    <!--write mode for output file:  WRITE_APPEND or WRITE_NEW-->
    <parameter name="LCIOWriteMode" type="string" value="WRITE_NEW"/>
    <!--Set it to true to remove intermediate EORE in merged runs-->
    <parameter name="SkipIntermediateEORE" type="bool" value="true"/>
    <!--will split output file if size in kB exceeds given value - doesn't work with APPEND and NEW-->
    <!--parameter name="SplitFileSizekB" type="int" value="500000"/-->
  </processor>

</marlin>
